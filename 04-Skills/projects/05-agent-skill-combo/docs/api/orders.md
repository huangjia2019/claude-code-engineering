# Orders API

> Auto-generated by api-generating Skill. Do not edit manually.

## Base Path

`/api/orders`

---

## Endpoints

### GET `/api/orders`

ðŸ”’ Requires authentication

**Description**: List all orders belonging to the currently authenticated user. The user ID is derived from the auth token (`req.user.id`). Returns only the calling user's own orders.

**Parameters**:

| Name | In | Type | Required | Description |
|------|----|------|----------|-------------|

**Response**:

| Status | Description |
|--------|-------------|
| 200 | Successfully retrieved order list |
| 401 | Unauthorized - missing or invalid auth token |

**Response Example**:

```json
{
  "data": [
    {
      "id": "ord_2001",
      "userId": "u_1001",
      "items": [{ "productId": "p_01", "quantity": 2 }],
      "status": "pending",
      "total": 59.98
    },
    {
      "id": "ord_2002",
      "userId": "u_1001",
      "items": [{ "productId": "p_03", "quantity": 1 }],
      "status": "shipped",
      "total": 120.00
    }
  ]
}
```

---

### GET `/api/orders/:id`

ðŸ”’ Requires authentication

**Description**: Get order detail by ID. Protected by `requireAuth` middleware. Users can only access their own orders; attempting to access another user's order returns 403.

**Parameters**:

| Name | In | Type | Required | Description |
|------|----|------|----------|-------------|
| id | path | string | Yes | Order ID |

**Response**:

| Status | Description |
|--------|-------------|
| 200 | Successfully retrieved order |
| 401 | Unauthorized - missing or invalid auth token |
| 403 | Forbidden - order belongs to another user |
| 404 | Order not found |

**Response Example**:

```json
{
  "data": {
    "id": "ord_2001",
    "userId": "u_1001",
    "items": [{ "productId": "p_01", "quantity": 2 }],
    "status": "pending",
    "total": 59.98
  }
}
```

---

### POST `/api/orders`

ðŸ”’ Requires authentication

**Description**: Create a new order. Protected by `requireAuth` middleware. Request body is validated against `orderSchema` via `validate` middleware. The `userId` is automatically set from the authenticated user; `status` is automatically initialized to `"pending"`.

**Parameters**:

| Name | In | Type | Required | Description |
|------|----|------|----------|-------------|

**Request Body**:

```json
{
  "items": [
    { "productId": "p_01", "quantity": 2 },
    { "productId": "p_03", "quantity": 1 }
  ],
  "total": 179.98
}
```

**Response**:

| Status | Description |
|--------|-------------|
| 201 | Order created successfully |
| 400 | Validation error - invalid request body |
| 401 | Unauthorized - missing or invalid auth token |

**Response Example**:

```json
{
  "data": {
    "id": "ord_2003",
    "userId": "u_1001",
    "items": [
      { "productId": "p_01", "quantity": 2 },
      { "productId": "p_03", "quantity": 1 }
    ],
    "status": "pending",
    "total": 179.98
  }
}
```

---

### GET `/api/orders/:id/status`

ðŸ”’ Requires authentication

**Description**: Get the current status of a specific order. Defined via chained `router.route('/:id/status').get(...)`. Protected by `requireAuth` middleware. Returns only the status field, not the full order object.

**Parameters**:

| Name | In | Type | Required | Description |
|------|----|------|----------|-------------|
| id | path | string | Yes | Order ID |

**Response**:

| Status | Description |
|--------|-------------|
| 200 | Successfully retrieved order status |
| 401 | Unauthorized - missing or invalid auth token |
| 404 | Order not found |

**Response Example**:

```json
{
  "status": "shipped"
}
```

---

### PUT `/api/orders/:id/status`

ðŸ”’ Requires authentication

**Description**: Update the status of a specific order. Defined via chained `router.route('/:id/status').put(...)`. Protected by `requireAuth` middleware. This route was discovered through source code analysis; the detection script captured only the GET handler on this chained route definition.

**Parameters**:

| Name | In | Type | Required | Description |
|------|----|------|----------|-------------|
| id | path | string | Yes | Order ID |

**Request Body**:

```json
{
  "status": "shipped"
}
```

**Response**:

| Status | Description |
|--------|-------------|
| 200 | Order status updated successfully |
| 401 | Unauthorized - missing or invalid auth token |
| 404 | Order not found |

**Response Example**:

```json
{
  "data": {
    "id": "ord_2001",
    "userId": "u_1001",
    "items": [{ "productId": "p_01", "quantity": 2 }],
    "status": "shipped",
    "total": 59.98
  }
}
```

---

## Error Codes

| Code | Message | Description |
|------|---------|-------------|
| 400 | Bad Request | Invalid input parameters |
| 401 | Unauthorized | Missing or invalid auth token |
| 403 | Forbidden | Cannot access another user's order |
| 404 | Not Found | Resource does not exist |
| 500 | Internal Server Error | Unexpected server error |
